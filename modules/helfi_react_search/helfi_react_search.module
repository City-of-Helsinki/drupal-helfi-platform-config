<?php

/**
 * @file
 * Contains hooks for helfi_react_search module.
 */

declare(strict_types=1);

use Drupal\Core\Form\FormStateInterface;
use Drupal\Core\Hook\Attribute\LegacyHook;
use Drupal\Core\StringTranslation\TranslatableMarkup;
use Drupal\helfi_react_search\Enum\CourseCategory;
use Drupal\helfi_react_search\Enum\EventCategory;
use Drupal\helfi_react_search\Hook\ReactSearchHooks;

/**
 * Event list type allowed values.
 */
function helfi_react_search_event_list_allowed_types(): array {
  return [
    'events' => new TranslatableMarkup('Events', [], ['context' => 'helfi_react_search']),
    'hobbies' => new TranslatableMarkup('Hobbies', [], ['context' => 'helfi_react_search']),
    'events_and_hobbies' => new TranslatableMarkup('Events and hobbies', [], ['context' => 'helfi_react_search']),
  ];
}

/**
 * Event count dropdown selectable values.
 *
 * @return int[]
 *   Values to select.
 */
function helfi_react_search_event_list_allowed_values_function(): array {
  return [
    3 => 3,
    5 => 5,
    10 => 10,
  ];
}

/**
 * Event categories dropdown selectable values.
 */
function helfi_react_search_event_list_allowed_event_categories(): array {
  $values = [];

  foreach (EventCategory::cases() as $category) {
    $values[$category->value] = $category->translation();
  }

  return $values;
}

/**
 * Hobby categories dropdown selectable values.
 */
function helfi_react_search_event_list_allowed_hobby_categories(): array {
  $values = [];

  foreach (CourseCategory::cases() as $category) {
    $values[$category->value] = $category->translation();
  }

  return $values;
}

/**
 * Implements hook_entity_bundle_info_alter().
 */
#[LegacyHook]
function helfi_react_search_entity_bundle_info_alter(array &$bundles): void {
  \Drupal::service(ReactSearchHooks::class)->entityBundleInfoAlter($bundles);
}

/**
 * Implements hook_preprocess_HOOK().
 */
#[LegacyHook]
function helfi_react_search_preprocess_paragraph(array &$variables): void {
  \Drupal::service(ReactSearchHooks::class)->preprocessParagraph($variables);
}

/**
 * Implements hook_theme().
 */
#[LegacyHook]
function helfi_react_search_theme(): array {
  return \Drupal::service(ReactSearchHooks::class)->theme();
}

/**
 * Implements hook_field_widget_single_element_form_alter().
 */
#[LegacyHook]
function helfi_react_search_field_widget_single_element_paragraphs_form_alter(array &$element, FormStateInterface $form_state, array $context): void {
  \Drupal::service(ReactSearchHooks::class)
    ->fieldWidgetSingleElementParagraphsFormAlter($element, $form_state, $context);
}

/**
 * Implements hook_preprocess_HOOK().
 */
#[LegacyHook]
function helfi_react_search_preprocess_form_element(array &$variables): void {
  \Drupal::service(ReactSearchHooks::class)->preprocessFormElement($variables);
}
