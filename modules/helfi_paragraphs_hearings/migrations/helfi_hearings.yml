langcode: en
status: true
dependencies:
  enforced:
    module:
      - helfi_paragraphs_hearings
id: helfi_hearings
migration_tags:
  - helfi_hearings
migration_group: helfi_hearings
label: 'Helfi hearings'
source:
  constants:
    HEARING_BASE_URL: 'https://kuulemiset.hel.fi/'
  ids:
    id:
      type: string
  plugin: url
  url: https://api.hel.fi/kerrokantasi/v1/hearing/?format=json&langcode=fi&open=true
  track_changes: true
  data_fetch_plugin: http
  data_parser_plugin: json
  item_selector: results
  fields:
    -
      name: id
      label: Id
      selector: id
    -
      name: title
      label: 'Title'
      selector: title/fi
    -
      name: title_en
      label: 'Title en'
      selector: title/en
    -
      name: title_sv
      label: 'Title sv'
      selector: title/sv
    -
      name: comments
      label: 'Comments'
      selector: n_comments
    -
      name: publish_on
      label: 'Open at'
      selector: open_at
    -
      name: unpublish_on
      label: 'Close at'
      selector: close_at
    -
      name: slug
      label: 'Slug'
      selector: slug
    -
      name: img_url
      label: 'Image url'
      selector: main_image/url
process:
  title: title
  langcode:
    plugin: default_value
    default_value: fi
  comments: n_comments
  publish_on: publish_on
  unpublish_on: unpublish_on
  url:
    plugin: concat
    source:
      - constants/HEARING_BASE_URL
      - slug
      - '?lang=fi'
      - '&headless=false'
  type:
    plugin: default_value
    default_value: hearing
destination:
  plugin: entity:node
